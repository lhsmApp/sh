<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="StaffDetailMapper">
	
<!-- 
 * 说明： 工资明细
 * 创建人：zhangxiaoliu
 * 创建时间：2017-06-19
 * @version
 -->
 
	<!--表名 -->
	<sql id="tableName">
		tb_staff_detail
	</sql>
	
	<!-- 字段 -->
    <sql id="Field"> BILL_CODE, BUSI_DATE, USER_CODE, USER_NAME, STAFF_IDENT, BANK_CARD, USER_GROP, USER_CATG, DEPT_CODE, ORG_UNIT, SAL_RANGE, POST_SALY, BONUS, CASH_BONUS, WORK_OT, BACK_SALY, RET_SALY, CHK_CASH, INTR_SGL_AWAD, SENY_ALLE, POST_ALLE, NS_ALLE, AREA_ALLE, EXPT_ALLE, TECH_ALLE, LIVE_EXPE, LIVE_ALLE, LEAVE_DM, HOUSE_ALLE, ITEM_ALLE, MEAL_EXPE, TRF_ALLE, TEL_EXPE, HLDY_ALLE, KID_ALLE, COOL_EXPE, EXT_SGL_AWAD, PRE_TAX_PLUS, GROSS_PAY, ENDW_INS, UNEMPL_INS, MED_INS, CASD_INS, HOUSE_FUND, SUP_PESN, TAX_BASE_ADJ, ACCRD_TAX, AFTER_TAX, ACT_SALY, GUESS_DIFF, CUST_COL1, CUST_COL2, CUST_COL3, CUST_COL4, CUST_COL5, CUST_COL6, CUST_COL7, CUST_COL8, CUST_COL9, CUST_COL10, ESTB_DEPT </sql>

    <!-- 字段值 -->
    <sql id="FieldValue"> #{BILL_CODE}, #{BUSI_DATE}, #{USER_CODE}, #{USER_NAME}, #{STAFF_IDENT}, #{BANK_CARD}, #{USER_GROP}, #{USER_CATG}, #{DEPT_CODE}, #{ORG_UNIT}, #{SAL_RANGE}, #{POST_SALY}, #{BONUS}, #{CASH_BONUS}, #{WORK_OT}, #{BACK_SALY}, #{RET_SALY}, #{CHK_CASH}, #{INTR_SGL_AWAD}, #{SENY_ALLE}, #{POST_ALLE}, #{NS_ALLE}, #{AREA_ALLE}, #{EXPT_ALLE}, #{TECH_ALLE}, #{LIVE_EXPE}, #{LIVE_ALLE}, #{LEAVE_DM}, #{HOUSE_ALLE}, #{ITEM_ALLE}, #{MEAL_EXPE}, #{TRF_ALLE}, #{TEL_EXPE}, #{HLDY_ALLE}, #{KID_ALLE}, #{COOL_EXPE}, #{EXT_SGL_AWAD}, #{PRE_TAX_PLUS}, #{GROSS_PAY}, #{ENDW_INS}, #{UNEMPL_INS}, #{MED_INS}, #{CASD_INS}, #{HOUSE_FUND}, #{SUP_PESN}, #{TAX_BASE_ADJ}, #{ACCRD_TAX}, #{AFTER_TAX}, #{ACT_SALY}, #{GUESS_DIFF}, #{CUST_COL1}, #{CUST_COL2}, #{CUST_COL3}, #{CUST_COL4}, #{CUST_COL5}, #{CUST_COL6}, #{CUST_COL7}, #{CUST_COL8}, #{CUST_COL9}, #{CUST_COL10}, #{ESTB_DEPT} </sql>
	
	<!-- 获取系统期间-->
	<select id="currentSection" parameterType="pd" resultType="String">
		select KEY_VALUE
		from tb_sys_config
		where KEY_CODE = 'SystemDataTime'
	</select>
	
	<!-- 获取数据库中表结构-->
	<select id="getTableColumns" parameterType="pd" resultType="com.fh.entity.TableColumns">
	    SELECT UPPER(column_name) column_name, 
	           column_comment, 
	           UPPER(data_type) data_type, 
	           UPPER(column_type) column_type,
	           UPPER(column_key) column_key, 
	           column_default 
	    FROM information_schema.columns 
	    WHERE table_name = 'tb_staff_detail'
	</select>
	
	<!-- 获取字典翻译类型-->
	<select id="getDicType" parameterType="String" resultType="String">
	    SELECT SRC_TYPE
	    FROM tb_tmpl_config_dict
	    WHERE DICT_CODE = #{DICT_CODE}
	</select>
	
	<!-- 获取字典-->
	<select id="getSysDictionaries" parameterType="String" resultType="pd">
	    SELECT SRC_TYPE
	    FROM tb_tmpl_config_dict
	    WHERE DICT_CODE = #{DICT_CODE}
	</select>
	
	<!-- 列表 -->
	<select id="datalistJqPage" parameterType="jqPage" resultType="pd">
		select
		<include refid="Field"></include>
		from 
		<include refid="tableName"></include>
		<where>
			<if test="pd.search!= null and pd.search != ''"><!-- 关键词检索 -->
				and #{pd.search}
			</if>
		</where>
		<if test="sidx != null and sidx.trim() != ''" >
			order by ${sidx} ${sord} 
    	</if>
		<if test="currentResult != null and rowNum != null" >           
              limit #{currentResult}, #{rowNum} 
        </if>
	</select>
	<select id="countJqGridExtend" parameterType="jqPage" resultType="int">
		select count(*) from <include refid="tableName"></include> 
		<where>
			<if test="pd.search!= null and pd.search != ''"><!-- 关键词检索 -->
				and #{pd.search}
			</if>
		</where>
	</select>
	<select id="getFooterSummary" parameterType="jqPage" resultType="pd">
		select #{pd.Userdata} from <include refid="tableName"></include> 
		<where>
			<if test="pd.search!= null and pd.search != ''"><!-- 关键词检索 -->
				and #{pd.search}
			</if>
		</where>
	</select>
	
	<!-- 新增 -->
	<insert id="save" parameterType="pd">
		<!-- insert into 
	    <include refid="tableName"></include>
		(
	    <include refid="Field"></include>
		) values (
	    <include refid="FieldValue"></include>
		) -->
	</insert>
	
	<!-- 删除-->
	<delete id="delete" parameterType="pd">
		<!-- delete from
		<include refid="tableName"></include>
		where 
			ID = #{ID} -->
	</delete>
	
	<!-- 修改 -->
	<update id="edit" parameterType="pd">
		<!-- update
	    <include refid="tableName"></include>
		set 
			CATEGORYNAME = #{CATEGORYNAME},
			PRODUCTNAME = #{PRODUCTNAME},
			COUNTRY = #{COUNTRY},
			PRICE = #{PRICE},
			QUANTITY = #{QUANTITY}
		where 
		    ID = #{ID} -->
	</update>
	
	<!-- 通过ID获取数据 -->
	<select id="findById" parameterType="pd" resultType="pd">
		<!-- select 
		<include refid="Field"></include>
		from 
		<include refid="tableName"></include>
		where 
			ID = #{ID} -->
	</select>
	
	<!-- 批量删除 -->
	<delete id="deleteAll" parameterType="String">
		<!-- delete from
		<include refid="tableName"></include>
		where 
			ID in
		<foreach item="item" index="index" collection="array" open="(" separator="," close=")">
                 #{item}
		</foreach> -->
	</delete>
	
	<!-- 批量保存 -->
	<update id="updateAll" parameterType="com.fh.entity.JqGridModel">
		<!-- <foreach item="item" index="index" collection="list" open=" " separator="; " close=" ">
		    <if test="item!=null">
		        update
		        <include refid="tableName"></include>
		        set 
		    	    CATEGORYNAME = #{item.CATEGORYNAME},
			        PRODUCTNAME = #{item.PRODUCTNAME},
			        COUNTRY = #{item.COUNTRY},
			        PRICE = #{item.PRICE},
			        QUANTITY = #{item.QUANTITY}
		        where 
		        ID = #{item.ID}
		    </if>
		</foreach> -->
	</update>
	
	<!-- 导出列表 -->
	<select id="exportList" parameterType="jqPage" resultType="pd">
		select
		<include refid="Field"></include>
		from 
		<include refid="tableName"></include>
		<where>
			<if test="pd.search!= null and pd.search != ''"><!-- 关键词检索 -->
				and #{pd.search}
			</if>
		</where>
		<if test="sidx != null" >
			order by ${sidx} ${sord} 
    	</if>
	</select>
	
	<!-- 导入-->
	<insert id="batchImport" parameterType="com.fh.entity.JqGridModel">
		<!-- <foreach item="item" index="index" collection="list" open=" " separator="; " close=" ">
		  <choose>
		    <when test="item!=null and item.ID != null and item.ID != '' and item.ID != 0 ">
		        insert into 
		        <include refid="tableName"></include>
			        (
			        ID,
		    	    CATEGORYNAME,
			        PRODUCTNAME,
			        COUNTRY,
			        PRICE,
			        QUANTITY
			        ) 
			    values (
			        #{item.ID},
		    	    #{item.CATEGORYNAME},
			        #{item.PRODUCTNAME},
			        #{item.COUNTRY},
			        #{item.PRICE},
			        #{item.QUANTITY}
			        )
		    </when>
		    <otherwise>
		        insert into 
		        <include refid="tableName"></include>
			        (
		    	    CATEGORYNAME,
			        PRODUCTNAME,
			        COUNTRY,
			        PRICE,
			        QUANTITY
			        ) 
			    values (
		    	    #{item.CATEGORYNAME},
			        #{item.PRODUCTNAME},
			        #{item.COUNTRY},
			        #{item.PRICE},
			        #{item.QUANTITY}
			        )
		    </otherwise>
		  </choose>
		</foreach> -->
	</insert>
	
</mapper>