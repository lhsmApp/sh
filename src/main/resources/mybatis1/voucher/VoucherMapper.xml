<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="VoucherMapper">

	<!--表名 -->
	<sql id="tableNameHouseFund">
		TB_HOUSE_FUND_SUMMY
	</sql>

	<sql id="tableNameSocialInc">
		TB_SOCIAL_INC_SUMMY
	</sql>

	<sql id="tableNameStaff">
		TB_STAFF_SUMMY
	</sql>

	<!-- 字段 -->
	<sql id="FieldHouseFund">
		BILL_CODE,
		BUSI_DATE,
		ESTB_DEPT,
		USER_GROP,
		SOC_INC_BASE,
		PER_BASIC_FUND,
		PER_SUPP_FUND,
		PER_TOTAL,
		DEPT_BASIC_FUND,
		DEPT_SUPP_FUND,
		DEPT_TOTAL,
		DEPT_CODE,
		USER_CATG,
		PMT_PLACE,
		CUST_COL1,
		CUST_COL2,
		CUST_COL3,
		CUST_COL4,
		CUST_COL5,
		CUST_COL6,
		CUST_COL7,
		CUST_COL8,
		CUST_COL9,
		CUST_COL10,
		ZRZC_CODE,
		BILL_STATE,
		BILL_USER,
		BILL_DATE
	</sql>

	<!-- 字段值 -->
	<sql id="FieldValueHouseFund">
		#{BILL_CODE},
		#{BUSI_DATE},
		#{ESTB_DEPT},
		#{USER_GROP},
		#{SOC_INC_BASE},
		#{PER_BASIC_FUND},
		#{PER_SUPP_FUND},
		#{PER_TOTAL},
		#{DEPT_BASIC_FUND},
		#{DEPT_SUPP_FUND},
		#{DEPT_TOTAL},
		#{DEPT_CODE},
		#{USER_CATG},
		#{PMT_PLACE},
		#{CUST_COL1},
		#{CUST_COL2},
		#{CUST_COL3},
		#{CUST_COL4},
		#{CUST_COL5},
		#{CUST_COL6},
		#{CUST_COL7},
		#{CUST_COL8},
		#{CUST_COL9},
		#{CUST_COL10},
		#{ZRZC_CODE},
		#{BILL_STATE},
		#{BILL_USER},
		#{BILL_DATE}
	</sql>

	<!-- 字段 -->
	<sql id="FieldSocialInc">
		BILL_CODE,
		BUSI_DATE,
		ESTB_DEPT,
		USER_GROP,
		SOC_INC_BASE,
		PER_ENDW_INS,
		PER_MED_INS,
		PER_UNEMPL_INS,
		PER_TOTAL,
		DEPT_ENDW_INS,
		DEPT_MED_INS,
		DEPT_UNEMPL_INS,
		EMPT_INJ_INS,
		MATY_INS,
		DEPT_TOTAL,
		DEPT_CODE,
		USER_CATG,
		PMT_PLACE,
		CUST_COL1,
		CUST_COL2,
		CUST_COL3,
		CUST_COL4,
		CUST_COL5,
		CUST_COL6,
		CUST_COL7,
		CUST_COL8,
		CUST_COL9,
		CUST_COL10,
		ZRZC_CODE,
		BILL_STATE,
		BILL_USER,
		BILL_DATE
	</sql>

	<!-- 字段值 -->
	<sql id="FieldValueSocialInc">
		#{BILL_CODE},
		#{BUSI_DATE},
		#{ESTB_DEPT},
		#{USER_GROP},
		#{SOC_INC_BASE},
		#{PER_ENDW_INS},
		#{PER_MED_INS},
		#{PER_UNEMPL_INS},
		#{PER_TOTAL},
		#{DEPT_ENDW_INS},
		#{DEPT_MED_INS},
		#{DEPT_UNEMPL_INS},
		#{EMPT_INJ_INS},
		#{MATY_INS},
		#{DEPT_TOTAL},
		#{DEPT_CODE},
		#{USER_CATG},
		#{PMT_PLACE},
		#{CUST_COL1},
		#{CUST_COL2},
		#{CUST_COL3},
		#{CUST_COL4},
		#{CUST_COL5},
		#{CUST_COL6},
		#{CUST_COL7},
		#{CUST_COL8},
		#{CUST_COL9},
		#{CUST_COL10},
		#{ZRZC_CODE},
		#{BILL_STATE},
		#{BILL_USER},
		#{BILL_DATE}
	</sql>

	<!-- 字段 -->
	<sql id="FieldStaff">
		BILL_CODE,
		BUSI_DATE,
		ESTB_DEPT,
		USER_GROP,
		USER_CATG,
		DEPT_CODE,
		ORG_UNIT,
		SAL_RANGE,
		POST_SALY,
		BONUS,
		CASH_BONUS,
		WORK_OT,
		BACK_SALY,
		RET_SALY,
		CHK_CASH,
		INTR_SGL_AWAD,
		SENY_ALLE,
		POST_ALLE,
		NS_ALLE,
		AREA_ALLE,
		EXPT_ALLE,
		TECH_ALLE,
		LIVE_EXPE,
		LIVE_ALLE,
		LEAVE_DM,
		HOUSE_ALLE,
		ITEM_ALLE,
		MEAL_EXPE,
		TRF_ALLE,
		TEL_EXPE,
		HLDY_ALLE,
		KID_ALLE,
		COOL_EXPE,
		EXT_SGL_AWAD,
		PRE_TAX_PLUS,
		GROSS_PAY,
		ENDW_INS,
		UNEMPL_INS,
		MED_INS,
		CASD_INS,
		HOUSE_FUND,
		SUP_PESN,
		TAX_BASE_ADJ,
		ACCRD_TAX,
		AFTER_TAX,
		ACT_SALY,
		GUESS_DIFF,
		CUST_COL1,
		CUST_COL2,
		CUST_COL3,
		CUST_COL4,
		CUST_COL5,
		CUST_COL6,
		CUST_COL7,
		CUST_COL8,
		CUST_COL9,
		CUST_COL10,
		ZRZC_CODE,
		BILL_STATE,
		BILL_USER,
		BILL_DATE
	</sql>

	<!-- 字段值 -->
	<sql id="FieldValueStaff">
		#{BILL_CODE},
		#{BUSI_DATE},
		#{ESTB_DEPT},
		#{USER_GROP},
		#{USER_CATG},
		#{DEPT_CODE},
		#{ORG_UNIT},
		#{SAL_RANGE},
		#{POST_SALY},
		#{BONUS},
		#{CASH_BONUS},
		#{WORK_OT},
		#{BACK_SALY},
		#{RET_SALY},
		#{CHK_CASH},
		#{INTR_SGL_AWAD},
		#{SENY_ALLE},
		#{POST_ALLE},
		#{NS_ALLE},
		#{AREA_ALLE},
		#{EXPT_ALLE},
		#{TECH_ALLE},
		#{LIVE_EXPE},
		#{LIVE_ALLE},
		#{LEAVE_DM},
		#{HOUSE_ALLE},
		#{ITEM_ALLE},
		#{MEAL_EXPE},
		#{TRF_ALLE},
		#{TEL_EXPE},
		#{HLDY_ALLE},
		#{KID_ALLE},
		#{COOL_EXPE},
		#{EXT_SGL_AWAD},
		#{PRE_TAX_PLUS},
		#{GROSS_PAY},
		#{ENDW_INS},
		#{UNEMPL_INS},
		#{MED_INS},
		#{CASD_INS},
		#{HOUSE_FUND},
		#{SUP_PESN},
		#{TAX_BASE_ADJ},
		#{ACCRD_TAX},
		#{AFTER_TAX},
		#{ACT_SALY},
		#{GUESS_DIFF},
		#{CUST_COL1},
		#{CUST_COL2},
		#{CUST_COL3},
		#{CUST_COL4},
		#{CUST_COL5},
		#{CUST_COL6},
		#{CUST_COL7},
		#{CUST_COL8},
		#{CUST_COL9},
		#{CUST_COL10},
		#{ZRZC_CODE},
		#{BILL_STATE},
		#{BILL_USER},
		#{BILL_DATE}
	</sql>

	<!-- 新增 -->
	<insert id="save" parameterType="pd">
		insert into
		<include refid="tableNameHouseFund"></include>
		(
		<include refid="FieldHouseFund"></include>
		) values (
		<include refid="FieldValueHouseFund"></include>
		)
	</insert>

	<!-- 删除 -->
	<delete id="delete" parameterType="pd">
		delete from
		<include refid="tableNameHouseFund"></include>
		where
		VOUCHER_ID = #{VOUCHER_ID}
	</delete>

	<!-- 修改 -->
	<update id="edit" parameterType="pd">
		update
		<include refid="tableNameHouseFund"></include>
		set
		BILL_CODE = #{BILL_CODE},
		BUSI_DATE = #{BUSI_DATE},
		ESTB_DEPT = #{ESTB_DEPT},
		USER_GROP = #{USER_GROP},
		SOC_INC_BASE = #{SOC_INC_BASE},
		PER_BASIC_FUND = #{PER_BASIC_FUND},
		PER_SUPP_FUND = #{PER_SUPP_FUND},
		PER_TOTAL = #{PER_TOTAL},
		DEPT_BASIC_FUND = #{DEPT_BASIC_FUND},
		DEPT_SUPP_FUND = #{DEPT_SUPP_FUND},
		DEPT_TOTAL = #{DEPT_TOTAL},
		DEPT_CODE = #{DEPT_CODE},
		USER_CATG = #{USER_CATG},
		PMT_PLACE = #{PMT_PLACE},
		CUST_COL1 = #{CUST_COL1},
		CUST_COL2 = #{CUST_COL2},
		CUST_COL3 = #{CUST_COL3},
		CUST_COL4 = #{CUST_COL4},
		CUST_COL5 = #{CUST_COL5},
		CUST_COL6 = #{CUST_COL6},
		CUST_COL7 = #{CUST_COL7},
		CUST_COL8 = #{CUST_COL8},
		CUST_COL9 = #{CUST_COL9},
		CUST_COL10 = #{CUST_COL10},
		ZRZC_CODE = #{ZRZC_CODE},
		BILL_STATE = #{BILL_STATE},
		BILL_USER = #{BILL_USER},
		BILL_DATE = #{BILL_DATE},
		VOUCHER_ID = VOUCHER_ID
		where
		VOUCHER_ID = #{VOUCHER_ID}
	</update>

	<!-- 通过ID获取数据 -->
	<select id="findById" parameterType="pd" resultType="pd">
		select
		<include refid="FieldHouseFund"></include>
		from
		<include refid="tableNameHouseFund"></include>
		where
		VOUCHER_ID = #{VOUCHER_ID}
	</select>

	<!-- Jq分页列表 -->
	<select id="datalistJqPage" parameterType="jqPage" resultType="pd">
		select A.*
		<!-- <if test="pd.TABLE_CODE=='TB_STAFF_SUMMY'"> <include refid="FieldStaff"></include> 
			</if> <if test="pd.TABLE_CODE=='TB_SOCIAL_INC_SUMMY'"> <include refid="FieldSocialInc"></include> 
			</if> <if test="pd.TABLE_CODE=='TB_HOUSE_FUND_SUMMY'"> <include refid="FieldHouseFund"></include> 
			</if> -->
		from ${pd.TABLE_CODE} A
		JOIN tb_sys_sealed_info B
		ON
		A.BILL_CODE=B.BILL_CODE
		AND A.BUSI_DATE=B.RPT_DUR
		WHERE B.STATE='1'
		AND
		B.BILL_TYPE=#{pd.BILL_TYPE}

		<!-- <if test="TABLE_CODE=='TB_STAFF_SUMMY'"> <include refid="tableNameStaff"></include> 
			</if> <if test="TABLE_CODE=='TB_SOCIAL_INC_SUMMY'"> <include refid="tableNameSocialInc"></include> 
			</if> <if test="TABLE_CODE=='TB_HOUSE_FUND_SUMMY'"> <include refid="tableNameHouseFund"></include> 
			</if> -->
		<where>
			<if test="pd.keywords!= null and pd.keywords != ''"><!-- 关键词检索 -->
				and
				(
				<!-- 根据需求自己加检索条件 字段1 LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') or 
					字段2 LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') -->
				)
			</if>
			<if test="pd.filterWhereResult != null">
				${pd.filterWhereResult}
			</if>
		</where>
		<if test="sidx != null">
			order by ${sidx} ${sord}
		</if>
		<if test="currentResult != null and rowNum != null">
			limit #{currentResult}, #{rowNum}
		</if>
	</select>

	<select id="countJqGrid" parameterType="pd" resultType="int">
		select count(*) from
		<include refid="tableNameHouseFund"></include>
		<where>
			<if test="keywords!= null and keywords != ''"><!-- 关键词检索 -->
				and
				(
				<!-- 根据需求自己加检索条件 字段1 LIKE CONCAT(CONCAT('%', #{keywords}),'%') or 字段2 
					LIKE CONCAT(CONCAT('%', #{keywords}),'%') -->
				)
			</if>
			<if test="filterWhereResult != null">
				${filterWhereResult}
			</if>
		</where>
	</select>

	<!-- 列表(全部) -->
	<select id="listAll" parameterType="pd" resultType="pd">
		select
		<include refid="FieldHouseFund"></include>
		from
		<include refid="tableNameHouseFund"></include>
	</select>

	<!-- 获取明细列表 -->
	<select id="listDetail" parameterType="pd" resultType="pd">
		select A.*
		from ${TABLE_CODE} A
		<!-- left join sys_dictionaries B on A.USER_GROP=B.BIANMA left join sys_dictionaries 
			C on A.USER_CATG=C.BIANMA left join sys_dictionaries D on A.PMT_PLACE=D.BIANMA 
			left join oa_department E on A.DEPT_CODE=E.DEPARTMENT_CODE left join oa_department 
			F on A.ESTB_DEPT=F.DEPARTMENT_CODE -->
		<where>
			A.BILL_CODE=#{BILL_CODE}
		</where>
	</select>

	<!-- 批量删除 -->
	<delete id="deleteAll" parameterType="String">
		delete from
		<include refid="tableNameHouseFund"></include>
		where
		VOUCHER_ID in
		<foreach item="item" index="index" collection="array" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</delete>
</mapper>